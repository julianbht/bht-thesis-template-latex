% Document class / style for theses at Berliner Hochschule für Technik
% S. Tschirley 2010
% [v2.0 2021] Updated due to university name change in 2021

% Identification
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{bht-cover-page}[2021/08/26 v2.0 BHT Thesis Style]

% Required packages
\RequirePackage{ifthen,ifluatex}
\RequirePackage{xcolor}
\RequirePackage{graphicx}
\RequirePackage{setspace}
\graphicspath{{cover/}}

% === User-facing metadata commands ===
\newcommand{\version}[1]{%
  \setboolean{@versionset}{true}%
  \renewcommand{\theVersion}{#1}%
}
\newcommand{\submissionDate}[1]{\renewcommand{\theSubmissionDate}{#1}}
\newcommand{\authorName}[1]{\renewcommand{\theAuthorName}{#1}}
\newcommand{\studentId}[1]{\renewcommand{\theStudentId}{#1}}
\newcommand{\thesisTitle}[1]{\renewcommand{\theThesisTitle}{#1}}
\newcommand{\thesisSubtitle}[1]{\renewcommand{\theThesisSubtitle}{#1}}
\newcommand{\department}[1]{\renewcommand{\theDepartment}{#1}}
\newcommand{\degreeProgram}[1]{\renewcommand{\theDegreeProgram}{#1}}
\newcommand{\degreeType}[1]{\renewcommand{\theDegreeType}{#1}}
\newcommand{\supervisorField}[1]{\renewcommand{\theSupervisorField}{#1}}

% === Colors (BHT corporate design) ===
\xdefinecolor{bhtGray}{rgb}{0.333, 0.333, 0.333}     % BHT dark gray, logo, text
\xdefinecolor{bhtTurquoise}{rgb}{0, 0.627, 0.666}    % BHT turquoise
\xdefinecolor{bhtCyan}{rgb}{0, 0.627, 0.666}         % BHT turquoise
\xdefinecolor{bhtYellow}{rgb}{1, 0.788, 0}           % BHT yellow (vivid orange)
\xdefinecolor{bhtRed}{rgb}{0.918, 0.231, 0.025}      % BHT red (vivid red)
\xdefinecolor{bhtBlue}{rgb}{0, 0.259, 0.510}         % BHT dark blue

% === reduced grays ===
\xdefinecolor{bhtVeryLightGray}{rgb}{0.93333333, 0.93333333, 0.93333333}

\newcommand{\headcolor}{bhtBlue}
\newcommand{\alertcolor}{bhtRed}

% === Internal defaults ===
\newcommand{\theVersion}{0.0}
\newcommand{\theSubmissionDate}{\today}
\newcommand{\theAuthorName}{Specify author!}
\newcommand{\theDegreeType}{Specify degree type!}
\newcommand{\theStudentId}{Specify student ID!}
\newcommand{\theThesisTitle}{Specify title!}
\newcommand{\theThesisSubtitle}{Specify subtitle!}
\newcommand{\theDepartment}{Specify department!}
\newcommand{\theDegreeProgram}{Specify degree program!}
\newcommand{\theSupervisorField}{Specify supervisor!}

% === Language toggle (default: English) ===
\newif\ifbhtCoverEnglish
\bhtCoverEnglishtrue

% Public interface: set language from main.tex
% Usage: \coverPageLanguage{en} or \coverPageLanguage{de}
\newcommand{\coverPageLanguage}[1]{%
  \ifthenelse{\equal{#1}{de}}{\bhtCoverEnglishfalse}{}%
  \ifthenelse{\equal{#1}{en}}{\bhtCoverEnglishtrue}{}%
}

% === Internal flags ===
\newboolean{@versionset}        \setboolean{@versionset}{false}
\newboolean{@versionsdatum}     \setboolean{@versionsdatum}{false}

% Avoid overfull \vbox warnings in headers
\headheight=14pt	

% Use custom title page macro
\renewcommand{\maketitle}{\bhtTitlePage}

% === User macros ===
\newcommand{\hslogoH}{BHT-Logo-horizontal.pdf}
\newcommand{\hslogoV}{BHT-Logo-vertikal.pdf}
\newcommand{\hslogoHscaled}[1]{\mbox{\includegraphics[width=#1]\hslogoH}}
\newcommand{\hslogoVscaled}[1]{\mbox{\includegraphics[width=#1]\hslogoV}}

% === Font setup (BHT corporate style) ===
\ifluatex
  \newcommand{\hsfont}{\fontseries{m}\fontshape{n}\selectfont}
  \newcommand{\hsheadfont}{\fontseries{b}\fontshape{n}\selectfont}
\else
  \newcommand{\hsfont}{\fontfamily{phv}\fontseries{m}\fontshape{n}\selectfont}
  \newcommand{\hsheadfont}{\fontfamily{phv}\fontseries{b}\fontshape{n}\selectfont}
\fi

% command that renders the cover page items
\newcommand{\bhtTitlePage}
	{
		\thispagestyle{empty}
		\parindent=0pt
        \hbadness=10000        % don't warn about underfull hboxes
        \hfuzz=100pt           % allow small overfull hboxes without warning
        \overfullrule=0pt      % don't draw black bars for overfull boxes
		%%
		\begin{minipage}[b]{0.75\textwidth}
			~\\\vspace{10ex}
			
            \begin{hsheadfont}
              {\hyphenpenalty=10000 \exhyphenpenalty=10000
               \textcolor{\headcolor}{\LARGE \theThesisTitle}\\[2ex]
               \textcolor{\headcolor}{\Large \theThesisSubtitle}\par}
            \end{hsheadfont}

		\end{minipage}
		\begin{minipage}[b]{0.25\textwidth}
			\raggedleft
			\includegraphics[width=0.6\textwidth]{\hslogoV}
		\end{minipage}
		\vfill
		%%
		\begin{minipage}[b]{0.8\textwidth}
			\begin{hsfont}
				  \ifbhtCoverEnglish
					submitted by \\[2ex]
					{\Large\theAuthorName}\\[2ex]
					% Student ID:\theStudentId\\[2ex] % uncomment if wanted
					to the Department \theDepartment\\
					of the Berlin University of Technology\\
					for the attainment of the academic degree\\[1ex]
					\textbf{\theDegreeType}\\[1ex]
					in the degree program\\[1ex]
					\textbf{\theDegreeProgram}  \\[5ex]
					Date of submission: \theSubmissionDate
				\else
					vorgelegt von\\[2ex]
					{\Large\theAuthorName}\\[2ex]
					dem Fachbereich \theDepartment\\
					der Berliner Hochschule für Technik Berlin\\
					zur Erlangung des akademischen Grades\\[1ex]
					\textbf{\theDegreeType}\\[1ex]
					im Studiengang\\[1ex]
					\textbf{\theDegreeProgram}  \\[5ex]
					Tag der Abgabe: \theSubmissionDate
				\fi
			\end{hsfont}
		\end{minipage}
		
		
		\hfill
		\begin{minipage}[b]{0.1\textwidth}
			\centering
			\includegraphics[scale=1]{BHT-Elements}\\[30ex]
		\end{minipage}
		\vfill
		%%
		\begin{minipage}[b]{0.7\textwidth}
			\begin{hsfont}
				\begin{tiny}
					\raggedright
					% Version number, if set
					\ifthenelse{\boolean{@versionset}}
						{Version \theVersion\\}
						{}
					% Date of last change, if desired
					\ifthenelse{\boolean{@versionsdatum}}
						{letzte Änderung: \today \\}
						{}
				\end{tiny}
			\end{hsfont}
			\vfill~
			\hspace{-1.5ex}\hsfont{\theSupervisorField}
		\end{minipage}
		\hfill
		\begin{minipage}[b]{0.1\textwidth}
			\centering
			\includegraphics[scale=1.4]{BHT-Studiere-vertikal}
		\end{minipage}
	}
